'use strict';
<% if (withDatabase) { %>var db = require('../lib/database');<% } %>
<% if (withLogger) { %>var logger = require('../lib/logger');<% } %>
<% if (withClientAuth) { %>var cacheHelper = require('../lib/cacheHelper');<% } %>

module.exports = function spec(app) {
    app.on('middleware:after:session', function configPassport(eventargs) {
    });

    app.on('middleware:before:router', function configAfterRouter(eventargs) {
    });

    app.on('middleware:after:router', function configAfterRouter(eventargs) {
        //app.use(errorMessages());
        <% if (withResponseJson) { %>app.use(responseJSON());<% } %>
    });

    return {
        onconfig: function(config, next) {
            //初始化数据库连接
            <% if (withLogger) { %>logger.init(config.get('loggerLevel'));<% } %>
            <% if (withDatabase) { %>db.config(config.get('databaseConfig'));<% } %>
            <% if (withClientAuth) { %>cacheHelper.config(config.get('cacheConfig'));<% } %>

            next(null, config);
        }
    };

};
